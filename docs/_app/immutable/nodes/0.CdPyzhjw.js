import"../chunks/DsnmJJEf.js";import{o as K,s as z}from"../chunks/D5R-hwFe.js";import{V as Q,W as X,Z as Y,_ as ee,$ as te,n as re,a0 as se}from"../chunks/FHZRGNLd.js";import{p as x,s as D,a as T,t as ne,f as ae}from"../chunks/BB8BSwVE.js";var F=class extends Error{constructor(e,t){super(t+""),this.status=e,this.value=t}},oe=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,ie=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,le=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,de=e=>e.trim().length!==0&&!Number.isNaN(Number(e)),J=e=>{if(typeof e!="string")return null;let t=e.replace(/"/g,"");if(oe.test(t)||ie.test(t)||le.test(t)){let r=new Date(t);if(!Number.isNaN(r.getTime()))return r}return null},fe=e=>{let t=e.charCodeAt(0),r=e.charCodeAt(e.length-1);return t===123&&r===125||t===91&&r===93},ce=e=>JSON.parse(e,(t,r)=>J(r)||r),O=e=>{if(!e)return e;if(de(e))return+e;if(e==="true")return!0;if(e==="false")return!1;let t=J(e);if(t)return t;if(fe(e))try{return ce(e)}catch{}return e},ue=e=>{let t=e.data.toString();return t==="null"?null:O(t)},pe=class{constructor(e){this.url=e,this.ws=new WebSocket(e)}ws;send(e){return Array.isArray(e)?(e.forEach(t=>this.send(t)),this):(this.ws.send(typeof e=="object"?JSON.stringify(e):e.toString()),this)}on(e,t,r){return this.addEventListener(e,t,r)}off(e,t,r){return this.ws.removeEventListener(e,t,r),this}subscribe(e,t){return this.addEventListener("message",e,t)}addEventListener(e,t,r){return this.ws.addEventListener(e,s=>{if(e==="message"){let l=ue(s);t({...s,data:l})}else t(s)},r),this}removeEventListener(e,t,r){return this.off(e,t,r),this}close(){return this.ws.close(),this}},he=["get","post","put","delete","patch","options","head","connect","subscribe"],P=["localhost","127.0.0.1","0.0.0.0"],R=typeof FileList>"u",W=e=>R?e instanceof Blob:e instanceof FileList||e instanceof File,ye=e=>{if(!e)return!1;for(let t in e)if(W(e[t])||Array.isArray(e[t])&&e[t].find(W))return!0;return!1},C=e=>R?e:new Promise(t=>{let r=new FileReader;r.onload=()=>{let s=new File([r.result],e.name,{lastModified:e.lastModified,type:e.type});t(s)},r.readAsArrayBuffer(e)}),g=(e,t,r={},s={})=>{if(Array.isArray(e)){for(let l of e)if(!Array.isArray(l))s=g(l,t,r,s);else{let f=l[0];if(typeof f=="string")s[f.toLowerCase()]=l[1];else for(let[a,w]of f)s[a.toLowerCase()]=w}return s}if(!e)return s;switch(typeof e){case"function":if(e instanceof Headers)return g(e,t,r,s);let l=e(t,r);return l?g(l,t,r,s):s;case"object":if(e instanceof Headers)return e.forEach((f,a)=>{s[a.toLowerCase()]=f}),s;for(let[f,a]of Object.entries(e))s[f.toLowerCase()]=a;return s;default:return s}};async function*me(e){let t=e.body;if(!t)return;let r=t.getReader(),s=new TextDecoder;try{for(;;){let{done:l,value:f}=await r.read();if(l)break;let a=s.decode(f);yield O(a)}}finally{r.releaseLock()}}var _=(e,t,r=[],s)=>new Proxy(()=>{},{get(l,f){return _(e,t,f==="index"?r:[...r,f],s)},apply(l,f,[a,w]){if(!a||w||typeof a=="object"&&Object.keys(a).length!==1||he.includes(r.at(-1))){let q=[...r],j=q.pop(),b="/"+q.join("/"),{fetcher:$=fetch,headers:k,onRequest:y,onResponse:L,fetch:G}=t,A=j==="get"||j==="head"||j==="subscribe";k=g(k,b,w);let M=A?a?.query:w?.query,N="";if(M){let n=(m,p)=>{N+=(N?"&":"?")+`${encodeURIComponent(m)}=${encodeURIComponent(p)}`};for(let[m,p]of Object.entries(M)){if(Array.isArray(p)){for(let i of p)n(m,i);continue}if(p!=null){if(typeof p=="object"){n(m,JSON.stringify(p));continue}n(m,`${p}`)}}}if(j==="subscribe"){let n=e.replace(/^([^]+):\/\//,e.startsWith("https://")?"wss://":e.startsWith("http://")||P.find(m=>e.includes(m))?"ws://":"wss://")+b+N;return new pe(n)}return(async()=>{let n={method:j?.toUpperCase(),body:a,...G,headers:k};n.headers={...k,...g(A?a?.headers:w?.headers,b,n)};let m=A&&typeof a=="object"?a.fetch:w?.fetch;if(n={...n,...m},A&&delete n.body,y){Array.isArray(y)||(y=[y]);for(let d of y){let o=await d(b,n);typeof o=="object"&&(n={...n,...o,headers:{...n.headers,...g(o.headers,b,n)}})}}if(A&&delete n.body,ye(a)){let d=new FormData;for(let[o,u]of Object.entries(n.body)){if(Array.isArray(u)){for(let v=0;v<u.length;v++){let S=u[v];d.append(o,S instanceof File?await C(S):S)}continue}if(R){d.append(o,u);continue}if(u instanceof File){d.append(o,await C(u));continue}if(u instanceof FileList){for(let v=0;v<u.length;v++)d.append(o,await C(u[v]));continue}d.append(o,u)}n.body=d}else typeof a=="object"?(n.headers["content-type"]="application/json",n.body=JSON.stringify(a)):a!=null&&(n.headers["content-type"]="text/plain");if(A&&delete n.body,y){Array.isArray(y)||(y=[y]);for(let d of y){let o=await d(b,n);typeof o=="object"&&(n={...n,...o,headers:{...n.headers,...g(o.headers,b,n)}})}}let p=e+b+N,i=await(s?.handle(new Request(p,n))??$(p,n)),c=null,E=null;if(L){Array.isArray(L)||(L=[L]);for(let d of L)try{let o=await d(i.clone());if(o!=null){c=o;break}}catch(o){o instanceof F?E=o:E=new F(422,o);break}}if(c!==null)return{data:c,error:E,response:i,status:i.status,headers:i.headers};switch(i.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":c=me(i);break;case"application/json":c=await i.json();break;case"application/octet-stream":c=await i.arrayBuffer();break;case"multipart/form-data":let d=await i.formData();c={},d.forEach((o,u)=>{c[u]=o});break;default:c=await i.text().then(O)}return(i.status>=300||i.status<200)&&(E=new F(i.status,c),c=null),{data:c,error:E,response:i,status:i.status,headers:i.headers}})()}return typeof a=="object"?_(e,t,[...r,Object.values(a)[0]],s):_(e,t,r)}}),be=(e,t={})=>typeof e=="string"?(t.keepDomain||(e.includes("://")||(e=(P.find(r=>e.includes(r))?"http://":"https://")+e),e.endsWith("/")&&(e=e.slice(0,-1))),_(e,t)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),_("http://e.ly",t,[],e));const we=e=>new Promise(t=>setTimeout(t,e)),ve=be("https://pulse.warsa.me");let h;function U(){h=ve.ws.subscribe(),h.on("open",Z),h.on("close",B),h.on("message",H),h.on("error",I)}const Z=()=>x.set(!0),B=()=>{x.set(!1),V()},H=e=>{const t=e.data;if(!t?.seq)return;const r=D(T);r.some(s=>s.seq===t?.seq)||T.set([t,...r])},I=()=>{D(x)&&V()};async function V(){h&&(T.set([]),console.log("Reconnecting WebSocket..."),h.removeEventListener("error",I),h.removeEventListener("message",H),h.removeEventListener("open",Z),h.removeEventListener("close",B),h=void 0,await we(1e3),U())}var ge=X('<main class="svelte-1nxcyx2"><!></main>');function _e(e,t){Q(t,!0);function r(){U()}K(r);var s=ge(),l=te(s);z(l,()=>t.children??re),se(s),ne(1,s,()=>ae,()=>({duration:300})),Y(e,s),ee()}export{_e as component};
